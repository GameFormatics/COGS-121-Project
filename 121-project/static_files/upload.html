 <!DOCTYPE html>
<html>
<head>
    <title>Choose/Upload</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Login</title>
    <link href="https://fonts.googleapis.com/css?family=Averia+Sans+Libre|Nunito" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="main.css">
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/numeric/1.2.6/numeric.min.js"></script>
</head>

<body>
    <!-- Navigation bar -->
    <div id="nav">
        <ul>
            <div style="float: left;">
                <li><a href="home.html"><button>Home</button></a></li>
                <li><a href="resources.html"><button>Resources</button></a><li>
            </div>
            <div style="float: right;">
                <li>
                    <a href="profile.html">
                        <img src="profile.png" width="40" height="auto" style="margin-top: 6px; margin-left: 5px;">
                    </a>
                </li>
                <li>
                    <a href="profile.html">
                        <button>Profile</button>
                    </a>
                </li>
                <li><a href="index.html"><button style="margin-right: 7px;">Logout</button></a></li>
            </div>
        </ul>
    </div>

    <br></br>
    <div style="text-align: center;">
          <br></br><br></br>
          <h1>Type what you said</h1>
          <textarea id="typeTextBox"></textarea>
          <br>
          <div id="buttons">
            <button id="typeTextButton">Analyze Text</button>
            <button id="getTextButton">Get Text</button>
          </div>
          <br></br>
          <div id="status"></div>
          <div id="results"></div>
          <div id="emotionTextPie"></div>
          <!-- <a href="results.html"><button id="typeTextButton">Analyze Text</button></a> -->
          <a href="home.html"><button>Return to Home Page</button></a>
          </p>
    </div>
</body>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script type="application/javascript" src="js_files/quizQuestions.js"></script>
<script type="text/javascript">
    $(document).ready(() => {
        $('#getTextButton').click(() => {
            $.ajax({
              url: 'text',
              type: 'GET',
              dataType : 'json',
              success: (data) => {
                console.log('You received some data!', data);
                console.log($('#typeTextBox').val());
                $('#status').empty();
                $('#results').empty();
                $('#results').append('<div class="data"><h2>' +  "Text Entered" +'</h2></div>');
                $('#results').append($('#typeTextBox').val());
                var total, sad_percent, joy_percent, disgust_percent, fear_percent, anger_percent;
                for(let key in data){
                      if(key == "sentiment"){
                        $('#results').append('<div class="data"><h2>' +  "Sentiment" +'</h2></div>');
                        $('#results').append('<div class="data"><h4>' + 'Score: ' + data.sentiment.document.score +'</h4></div>');
                          $('#results').append('<div class="data"><h4>' + 'Label: ' + data.sentiment.document.label +'</h4></div>');
                      }
                      if(key == "emotion"){
                        $('#results').append('<div class="data"><h2>' + "Emotion" +'</h2></div>');
                        $('#results').append('<div class="data"><h4>' + 'Sadness: ' + data.emotion.document.emotion.sadness +'</h4></div>');
                        $('#results').append('<div class="data"><h4>' + 'Joy: ' + data.emotion.document.emotion.joy +'</h4></div>');
                        $('#results').append('<div class="data"><h4>' + 'Disgust: ' + data.emotion.document.emotion.disgust +'</h4></div>');
                        $('#results').append('<div class="data"><h4>' + 'Fear: ' + data.emotion.document.emotion.fear +'</h4></div>');
                        $('#results').append('<div class="data"><h4>' + 'Anger: ' + data.emotion.document.emotion.anger +'</h4></div>');
                        total = (data.emotion.document.emotion.sadness + data.emotion.document.emotion.joy + data.emotion.document.emotion.disgust + data.emotion.document.emotion.fear + data.emotion.document.emotion.anger);
                        sad_percent = (data.emotion.document.emotion.sadness/total);
                        joy_percent = (data.emotion.document.emotion.joy/total);
                        disgust_percent = (data.emotion.document.emotion.disgust/total);
                        fear_percent = (data.emotion.document.emotion.fear/total);
                        anger_percent = (data.emotion.document.emotion.anger/total);
                      }
                  }

                  var data = [{
                    values: [sad_percent, joy_percent, disgust_percent, fear_percent, anger_percent],
                    labels: ['Sadness', 'Joy', 'Disgust', 'Fear', 'Anger'],
                    type: 'pie'
                  }];

                  var layout= {
                    plot_bgcolor:"rgba(0,0,0,0)",
                    paper_bgcolor:"rgba(0,0,0,0)",
                    font: {
                      family: "FiraSans-Regular",
                      size: 18,
                      color: "white"
                    }
                  }

                  Plotly.newPlot('emotionTextPie', data, layout);
                  }

          })
        });

        $('#typeTextButton').click(() => {
            $.ajax({
              // all URLs are relative to http://localhost:3000/
              url: 'text',
              type: 'POST', // <-- this is POST, not GET
              data: {
                      words: $('#typeTextBox').val(),
                    },
              error: function(){
                console.log('Failed to submit text.');
                $('#status').html('Failed to submit text. Please try again.');
              },
              success: (data) => {
                console.log('Successfully submitted text!');
                $('#status').html('Successfully submitted! Press "Get Text" to read results.');
                $('#results').empty();
              }
            });
          });
        });
</script>
</html>

<!--Deprecated code pls ignore-->
<!-- Commented out as it does not provide to functionality
<div class="options">
    <br></br>
    <h1>Choose a Game</h1>
    <a href="https://www.epicgames.com/fortnite"><button>Fortnite</button></a>
    <a href="https://na.leagueoflegends.com/en/"><button>League of Legends</button></a>
    <a href="https://playoverwatch.com/"><button>Overwatch</button></a>
</div>
-->
    <!-- Commented out because of audio.html
    <br></br><br></br>
    <form class="fileupload" action="upload" method="post" enctype="multipart/form-data">
      <h1>Upload Audio Here (Must be .mp3 format!)</h1>
      <input type="file" name="upfile" value="">
      <input type="submit" />
    </form> -->
